{
  "trigger": "webhook.new_order",
  "actions": [
    {
      "action": "httprequest.fraud_check",
      "params": {
        "url": "https://api.fraudcheck.com",
        "method": "POST"
      },
      "mode": "sequential"
    },
    {
      "action": "if.fraud_detected",
      "params": {
        "conditions": {
          "leftValue": "={{ $json.fraud_score }}",
          "rightValue": 0.7,
          "operator": {
            "type": "number",
            "operation": "gt",
            "singleValue": true
          }
        }
      },
      "mode": "sequential"
    },
    {
      "action": "httprequest.block_order",
      "params": {
        "url": "https://api.orders.com/block",
        "method": "POST"
      },
      "mode": "branch_true"
    },
    {
      "action": "if.payment_status_check",
      "params": {
        "conditions": {
          "leftValue": "={{ $json.payment_status }}",
          "rightValue": "paid",
          "operator": {
            "type": "string",
            "operation": "equals",
            "singleValue": true
          }
        }
      },
      "mode": "branch_false"
    },
    {
      "action": "airtable.check_stock",
      "params": {
        "table": "inventory"
      },
      "mode": "branch_true"
    },
    {
      "action": "if.stock_low",
      "params": {
        "conditions": {
          "leftValue": "={{ $json.stock }}",
          "rightValue": 5,
          "operator": {
            "type": "number",
            "operation": "lt",
            "singleValue": true
          }
        }
      },
      "mode": "branch_true"
    },
    {
      "action": "gmail.send_alert",
      "params": {
        "to": "warehouse@example.com",
        "subject": "Low Stock Warning",
        "message": "Order placed but stock is below threshold."
      },
      "mode": "branch_true"
    },
    {
      "action": "httprequest.fulfill_order",
      "params": {
        "url": "https://api.orders.com/fulfill",
        "method": "POST"
      },
      "mode": "branch_false"
    },
    {
      "action": "slack.post_message",
      "params": {
        "channel": "#finance",
        "message": "Order placed but payment not completed."
      },
      "mode": "branch_false"
    }
  ]
}
